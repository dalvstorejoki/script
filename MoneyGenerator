local Players = game:GetService("Players")
-- Automatically gets the player executing the script
local Player = Players.LocalPlayer 
local PlayerGui = Player:WaitForChild("PlayerGui")

-- Wait for leaderstats
local Leaderstats = Player:WaitForChild("leaderstats", 5)
local MoneyStat = Leaderstats and Leaderstats:WaitForChild("Money", 5)

-- Create main screen GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MoneyGenerator"
ScreenGui.Parent = PlayerGui

-- Main frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 350, 0, 340)
MainFrame.Position = UDim2.new(0.5, -175, 0.5, -170)
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = true
MainFrame.Parent = ScreenGui

-- Draggable
MainFrame.Active = true
MainFrame.Draggable = true

-- Corner rounding
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

-- Title (Left Aligned, Updated Text)
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -20, 0, 40)
Title.Position = UDim2.new(0, 15, 0, 0) -- 15px padding from left
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
-- === CHANGED TITLE HERE ===
Title.Text = "Money Generator by Fb: Dalvstore"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Left -- Aligned Left
Title.Parent = MainFrame

-- Title Background (to cover the full width for color consistency)
local TitleBg = Instance.new("Frame")
TitleBg.Size = UDim2.new(1, 0, 0, 40)
TitleBg.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TitleBg.BorderSizePixel = 0
TitleBg.ZIndex = 0
TitleBg.Parent = MainFrame
local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = TitleBg
-- Flatten bottom corners of title bg
local TitleBottomFlat = Instance.new("Frame")
TitleBottomFlat.Size = UDim2.new(1, 0, 0, 10)
TitleBottomFlat.Position = UDim2.new(0, 0, 1, -10)
TitleBottomFlat.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TitleBottomFlat.BorderSizePixel = 0
TitleBottomFlat.Parent = TitleBg

-- Input frame
local InputFrame = Instance.new("Frame")
InputFrame.Size = UDim2.new(0.9, 0, 0, 100)
InputFrame.Position = UDim2.new(0.05, 0, 0.15, 0)
InputFrame.BackgroundTransparency = 1
InputFrame.Parent = MainFrame

-- Amount input
local AmountLabel = Instance.new("TextLabel")
AmountLabel.Size = UDim2.new(0, 80, 0, 30)
AmountLabel.Position = UDim2.new(0, 0, 0, 0)
AmountLabel.BackgroundTransparency = 1
AmountLabel.Text = "Amount:"
AmountLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
AmountLabel.TextSize = 14
AmountLabel.TextXAlignment = Enum.TextXAlignment.Left
AmountLabel.Parent = InputFrame

local AmountBox = Instance.new("TextBox")
AmountBox.Size = UDim2.new(0, 100, 0, 35)
AmountBox.Position = UDim2.new(0, 80, 0, 0)
AmountBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
AmountBox.Text = "400"
AmountBox.TextColor3 = Color3.fromRGB(255, 255, 255)
AmountBox.TextSize = 16
AmountBox.PlaceholderText = "Amount"
AmountBox.Parent = InputFrame

-- Symbol selection
local SymbolLabel = Instance.new("TextLabel")
SymbolLabel.Size = UDim2.new(0, 80, 0, 30)
SymbolLabel.Position = UDim2.new(0, 0, 0, 50)
SymbolLabel.BackgroundTransparency = 1
SymbolLabel.Text = "Symbol:"
SymbolLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
SymbolLabel.TextSize = 14
SymbolLabel.TextXAlignment = Enum.TextXAlignment.Left
SymbolLabel.Parent = InputFrame

local SymbolBox = Instance.new("TextBox")
SymbolBox.Size = UDim2.new(0, 80, 0, 35)
SymbolBox.Position = UDim2.new(0, 80, 0, 50)
SymbolBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
SymbolBox.Text = "K"
SymbolBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SymbolBox.TextSize = 16
SymbolBox.Parent = InputFrame

-- Symbol arrows
local UpButton = Instance.new("TextButton")
UpButton.Size = UDim2.new(0, 30, 0, 15)
UpButton.Position = UDim2.new(0, 165, 0, 50)
UpButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
UpButton.Text = "‚ñ≤"
UpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
UpButton.TextSize = 12
UpButton.Parent = InputFrame

local DownButton = Instance.new("TextButton")
DownButton.Size = UDim2.new(0, 30, 0, 15)
DownButton.Position = UDim2.new(0, 165, 0, 70)
DownButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
DownButton.Text = "‚ñº"
DownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
DownButton.TextSize = 12
DownButton.Parent = InputFrame

-- === TOTAL FRAME ===
local TotalFrame = Instance.new("Frame")
TotalFrame.Size = UDim2.new(0.9, 0, 0, 40)
TotalFrame.Position = UDim2.new(0.05, 0, 0.5, 0)
TotalFrame.BackgroundTransparency = 1
TotalFrame.Parent = MainFrame

local TotalLabelTitle = Instance.new("TextLabel")
TotalLabelTitle.Size = UDim2.new(0, 60, 1, 0)
TotalLabelTitle.BackgroundTransparency = 1
TotalLabelTitle.Text = "Total:"
TotalLabelTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
TotalLabelTitle.TextSize = 14
TotalLabelTitle.TextXAlignment = Enum.TextXAlignment.Left
TotalLabelTitle.Parent = TotalFrame

-- Total Box (Width adjusted to fit toggle)
local TotalValueBox = Instance.new("TextBox")
TotalValueBox.Size = UDim2.new(1, -130, 1, 0) -- Make room for toggle
TotalValueBox.Position = UDim2.new(0, 60, 0, 0)
TotalValueBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
TotalValueBox.Text = "Loading..."
TotalValueBox.TextColor3 = Color3.fromRGB(255, 215, 0)
TotalValueBox.TextSize = 14
TotalValueBox.Font = Enum.Font.Gotham
TotalValueBox.TextEditable = false
TotalValueBox.ClearTextOnFocus = false
TotalValueBox.Parent = TotalFrame

-- === TOGGLE SWITCH ===
local ToggleContainer = Instance.new("Frame")
ToggleContainer.Size = UDim2.new(0, 60, 1, 0)
ToggleContainer.Position = UDim2.new(1, -60, 0, 0)
ToggleContainer.BackgroundTransparency = 1
ToggleContainer.Parent = TotalFrame

local LiveLabel = Instance.new("TextLabel")
LiveLabel.Size = UDim2.new(1, 0, 0, 15)
LiveLabel.Position = UDim2.new(0, 0, 0, -5)
LiveLabel.BackgroundTransparency = 1
LiveLabel.Text = "LIVE"
LiveLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
LiveLabel.TextSize = 10
LiveLabel.Parent = ToggleContainer

local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 40, 0, 20)
ToggleButton.Position = UDim2.new(0.5, -20, 0.5, 0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60) -- Default OFF color
ToggleButton.Text = ""
ToggleButton.AutoButtonColor = false
ToggleButton.Parent = ToggleContainer

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(1, 0) -- Pill shape
ToggleCorner.Parent = ToggleButton

local ToggleKnob = Instance.new("Frame")
ToggleKnob.Size = UDim2.new(0, 16, 0, 16)
ToggleKnob.Position = UDim2.new(0, 2, 0.5, -8) -- Left position (OFF)
ToggleKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ToggleKnob.Parent = ToggleButton

local KnobCorner = Instance.new("UICorner")
KnobCorner.CornerRadius = UDim.new(1, 0) -- Circle
KnobCorner.Parent = ToggleKnob

-- ==========================

-- Result display
local ResultLabel = Instance.new("TextLabel")
ResultLabel.Size = UDim2.new(0.9, 0, 0, 30)
ResultLabel.Position = UDim2.new(0.05, 0, 0.65, 0)
ResultLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
ResultLabel.Text = "" 
ResultLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
ResultLabel.TextSize = 16
ResultLabel.BackgroundTransparency = 1
ResultLabel.Parent = MainFrame

-- Generate button
local GenerateButton = Instance.new("TextButton")
GenerateButton.Size = UDim2.new(0.9, 0, 0, 40)
GenerateButton.Position = UDim2.new(0.05, 0, 0.8, 0)
GenerateButton.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
GenerateButton.Text = "GENERATE"
GenerateButton.TextColor3 = Color3.fromRGB(255, 255, 255)
GenerateButton.TextSize = 16
GenerateButton.Font = Enum.Font.GothamBold
GenerateButton.Parent = MainFrame

-- Minimize button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Position = UDim2.new(1, -70, 0, 5)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(80, 80, 200)
MinimizeButton.Text = "‚Äî" 
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 16
MinimizeButton.ZIndex = 2
MinimizeButton.Parent = MainFrame

-- Close button
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 14
CloseButton.ZIndex = 2
CloseButton.Parent = MainFrame

-- Mini Icon
local MiniIcon = Instance.new("TextButton")
MiniIcon.Size = UDim2.new(0, 50, 0, 50)
MiniIcon.Position = UDim2.new(0, 10, 0, 10)
MiniIcon.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
MiniIcon.Text = "üè¶"
MiniIcon.TextColor3 = Color3.fromRGB(255, 255, 255)
MiniIcon.TextSize = 20
MiniIcon.Visible = false
MiniIcon.Parent = ScreenGui

-- Draggable
MiniIcon.Active = true
MiniIcon.Draggable = true

local MiniCorner = Instance.new("UICorner")
MiniCorner.CornerRadius = UDim.new(0, 8)
MiniCorner.Parent = MiniIcon

-- ================= LOGIC SECTION =================

local commonSuffixes = {"", "K", "M", "B", "T", "q", "Q"}
local currentSuffixIndex = 54 -- Default "uuu"
local isLiveLimited = false -- Default toggle state: OFF

-- 1. Generate Suffix String
function generateSuffix(index)
    if index <= #commonSuffixes then
        return commonSuffixes[index]
    end
    local customIndex = index - #commonSuffixes
    local length = 2 
    local maxForLength = 26
    while customIndex > maxForLength do
        customIndex = customIndex - maxForLength
        length = length + 1
        maxForLength = 26
    end
    local charIndex = customIndex
    local charCode = 96 + charIndex
    local char = string.char(charCode)
    return char:rep(length)
end

-- 2. Get Max Suffixes
function getTotalSuffixes()
    return #commonSuffixes + 26 + 26 + 26 + 26
end

-- 3. Calculate Exponent
function getSuffixExponent(suffix)
    if suffix == nil or suffix == "" then return 0 end
    local commonMap = { K = 3, M = 6, B = 9, T = 12, q = 15, Q = 18 }
    if commonMap[suffix] then return commonMap[suffix] end
    
    local firstChar = suffix:sub(1, 1):lower()
    local suffixLength = #suffix
    for i = 2, suffixLength do
        if suffix:sub(i, i):lower() ~= firstChar then return 0 end
    end
    
    local charIndex = string.byte(firstChar) - 96
    local baseExponent = 18 
    local stepsFromA = charIndex - 1
    local lengthBonus = (suffixLength - 2) * 78 
    return baseExponent + (stepsFromA * 3) + lengthBonus + 3
end

-- 4. Helper: Parse Money String
function parseMoneyString(val)
    if type(val) == "number" then return val end
    if type(val) ~= "string" then return 0 end
    local numStr, suffix = val:match("([%d%.]+)([%a]*)")
    if not numStr then return 0 end
    local number = tonumber(numStr) or 0
    local exponent = getSuffixExponent(suffix)
    return number * (10 ^ exponent)
end

-- 5. Helper: Format Number to Suffix
function formatValueToSuffix(value)
    if value == 0 then return "0" end
    if value < 1000 then return string.format("%.2f", value) end
    
    local exponent = math.floor(math.log10(value))
    local tier = math.floor(exponent / 3)
    local suffixIndex = tier
    local suffixStr = generateSuffix(suffixIndex + 1)
    
    -- === LIVE LIMIT LOGIC ===
    if isLiveLimited then
        local limitSuffix = "www"
        local limitExponent = getSuffixExponent(limitSuffix)
        
        if exponent >= limitExponent then
            local divisor = 10 ^ limitExponent
            local displayNum = value / divisor
            return string.format("%.2f%s", displayNum, limitSuffix)
        end
    end
    -- ========================
    
    local divisor = 10 ^ (tier * 3)
    local displayNum = value / divisor
    
    return string.format("%.2f%s", displayNum, suffixStr)
end

-- 6. Calculate N
function calculateN(number, suffix)
    local baseNumber = tonumber(number)
    if not baseNumber or baseNumber <= 0 then
        return "Error: Amount must be a number > 0"
    end
    local exponent = getSuffixExponent(suffix)
    local multiplier = 10 ^ exponent
    local actualValue = baseNumber * multiplier
    local n = actualValue / 40
    return math.floor(n + 0.5)
end

-- 7. Get Script Value
function getScriptValue(num)
    if num > 10^15 then
        local sciNotation = string.format("%.2e", num)
        local base, exponentStr = sciNotation:match("([%d%.]+)e([%d%-]+)")
        if base and exponentStr then
            local exponent = tonumber(exponentStr)
            if exponent >= 0 then return base .. "e+" .. exponentStr
            else return base .. "e-" .. math.abs(exponent) end
        end
    end
    return tostring(num)
end

-- ================= UPDATERS =================

function updateSymbol()
    SymbolBox.Text = generateSuffix(currentSuffixIndex)
    updateCalculations()
end

function updateCalculations()
    local inputNum = tonumber(AmountBox.Text) or 0
    local inputSuffix = SymbolBox.Text
    local inputRawValue = 0
    
    local n = calculateN(inputNum, inputSuffix)
    
    if type(n) == "number" then
        ResultLabel.Text = ""
        inputRawValue = inputNum * (10 ^ getSuffixExponent(inputSuffix))
    else
        ResultLabel.Text = n
        ResultLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        inputRawValue = 0
    end
    
    local currentMoneyRaw = 0
    if MoneyStat then
        currentMoneyRaw = parseMoneyString(MoneyStat.Value)
    end
    
    local totalRaw = currentMoneyRaw + inputRawValue
    TotalValueBox.Text = formatValueToSuffix(totalRaw)
end

-- ================= EVENTS =================

-- Toggle Button Event
ToggleButton.MouseButton1Click:Connect(function()
    isLiveLimited = not isLiveLimited
    
    if isLiveLimited then
        -- Swipe Right (ON)
        ToggleKnob:TweenPosition(UDim2.new(1, -18, 0.5, -8), "Out", "Quad", 0.2, true)
        ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 200, 100) -- Green
    else
        -- Swipe Left (OFF)
        ToggleKnob:TweenPosition(UDim2.new(0, 2, 0.5, -8), "Out", "Quad", 0.2, true)
        ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60) -- Grey
    end
    
    updateCalculations()
end)

UpButton.MouseButton1Click:Connect(function()
    currentSuffixIndex = math.min(currentSuffixIndex + 1, getTotalSuffixes())
    updateSymbol()
end)

DownButton.MouseButton1Click:Connect(function()
    currentSuffixIndex = math.max(currentSuffixIndex - 1, 1)
    updateSymbol()
end)

AmountBox:GetPropertyChangedSignal("Text"):Connect(updateCalculations)
SymbolBox:GetPropertyChangedSignal("Text"):Connect(updateCalculations)

if MoneyStat then
    MoneyStat.Changed:Connect(function()
        updateCalculations()
    end)
else
    TotalValueBox.Text = "Money stat not found"
end

GenerateButton.MouseButton1Click:Connect(function()
    local number = tonumber(AmountBox.Text) or 400
    local suffix = SymbolBox.Text
    local n = calculateN(number, suffix)
    
    if type(n) == "number" then
        local scriptValue = getScriptValue(n)
        local scriptToExecute = string.format([[
local args = {
7000001,
-%s
}
game:GetService("ReplicatedStorage"):WaitForChild("Tool"):WaitForChild("DrawUp"):WaitForChild("Msg"):WaitForChild("DrawHero"):InvokeServer(unpack(args))
]], scriptValue)
        
        loadstring(scriptToExecute)()
        
        ResultLabel.Text = "Generated!"
        ResultLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        wait(2)
        updateCalculations()
    else
        ResultLabel.Text = "Error: Invalid input"
        ResultLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    end
end)

MinimizeButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    MiniIcon.Visible = true
end)

MiniIcon.MouseButton1Click:Connect(function()
    MainFrame.Visible = true
    MiniIcon.Visible = false
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Initialize
updateSymbol()

